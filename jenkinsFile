pipeline {
    agent any

    stages {
        stage('Checkout') {
            steps {
                // Récupérer le code source depuis le dépôt Git
                git url: 'https://github.com/BasmaUvt/ProjetDXC.git', branch: 'master'
                
            }
        }

        stage('Install') {
            steps {
                // Installer les dépendances du projet
                bat 'npm install'
            }
        }

       // stage('Build') {
           // steps {
                // Exécuter les scripts de build 
                
           // }
       // }

        stage('Test') {
            steps {
                // Exécuter les tests de votre projet
                
                bat 'npm test'
            }
        }
         post {
        failure {
            emailext (
                subject: "Le job '${env.JOB_NAME}' a échoué",
                body: "L'URL du job est : ${env.BUILD_URL}",
                recipientProviders: [[$class: 'DevelopersRecipientProvider']],
                to: 'besma.rakrouki2@dxc.com'
            )
        }
    }

        //stage('Deploy') {
          //  when {
            //    anyOf {
                 //   branch 'master'
                 //   branch 'dev'
                  //  branch 'test'
               // }
          //  }
          //  steps {
                // Déployer  l'application en fonction de la branche
               
            //    script {
             //       if (env.BRANCH_NAME == 'master') {
             //           // Déployer sur l'environnement de production
              //          echo "Deploying to production environment"
              //      } else if (env.BRANCH_NAME == 'dev') {
                        // Déployer sur l'environnement de développement
               //         echo "Deploying to development environment"
               //     } else if (env.BRANCH_NAME == 'test') {
                        // Déployer sur l'environnement de test
               //         echo "Deploying to testing environment"
               //     }
               // }
         //   }
      //  }
    }
}